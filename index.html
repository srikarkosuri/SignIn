<!DOCTYPE html>
<html>

  <head>
    
    <title>Signin Template for Bootstrap</title>
    
    <meta name="google-signin-client_id" content="895723208328-5e4irkrhg4n3gvc9g2mpa1om7f0c2ub1.apps.googleusercontent.com">
    
    <link rel="stylesheet" type="text/css" href="signin.css">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
  </head>

  <body onload = "hasCookie();">

    <div class="background1"></div>

      <h1 class ="headertext"> Welcome to LifeFuels! </h1>
        <h2 class="form-signin-heading">Please sign in</h2>

      
       <div class="g-signin2" data-onsuccess="onSignIn" ></div>
      <div class = "wrapper">
        <button href = "#" onclick="signOut();" type ="submit" class = "signoutbutton">Sign out</button>
      </div>

    </div> <!-- /container -->


  </body>
  <script type="text/javascript">
      function onSignIn(googleUser) {
        //alert('used');
        var profile = googleUser.getBasicProfile();
        console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
        console.log('Name: ' + profile.getName());
        console.log('Image URL: ' + profile.getImageUrl());
        console.log('Email: ' + profile.getEmail());
        if(!isLifeFuels(profile.getEmail())){
            alert('unauthorized');
            document.cookie = "unauthorized=" +profile.getEmail();
            window.location.href = "unauthorized.html";  

        }
        if(isLifeFuels(profile.getEmail())){
            alert("lifefuels");
             document.cookie="authorized = 1"; 
             window.location.href = "http://office.lifefuels.co/";
        }

          
      }
      function signOut() {
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
        console.log('User signed out.');
      });
    }
    function isLifeFuels(email){
      var name = "lifefuels.co";
        if (email.indexOf(name) > -1) {
          return true;
        }
      return false;
    }
    function hasCookie(){
      if(document.cookie.indexOf("authorized=1"))
        alert("I know you've been here!");
        //window.location.href= "http://office.lifefuels.co/"
    }

    </script>
</html>
